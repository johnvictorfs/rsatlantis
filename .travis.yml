language: python

sudo: required

dist: xenial

services:
  - postgresql

python:
  - 3.8

env:
  - DJANGO=2.2.6

before_script:
  - psql -c 'create database travis_ci_test;' -U postgres

before_install:
  - export DJANGO_SETTINGS_MODULE=backend.settings
  - cd backend/
  - curl -sSL https://raw.githubusercontent.com/sdispater/poetry/master/get-poetry.py | python

install:
  - source $HOME/.poetry/env
  - poetry self:update 0.9.0
  - python -m poetry install

script:
  - poetry run python manage.py test
  - cd ../frontend
  - yarn install && yarn lint && yarn test
